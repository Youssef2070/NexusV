<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NexusV Empire</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --gold: #ffd700; --diamond: #00d1ff; --bg: #000; --red: #ff3b30; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: #fff; font-family: 'Helvetica Neue', sans-serif; overflow: hidden; height: 100%; }

        /* 1. SPLASH SCREEN (LOGO V LUMINEUX) */
        #splash {
            position: fixed; inset: 0; background: #000; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.8s ease-in-out;
        }
        .grand-v {
            font-size: 140px; font-weight: 900; color: var(--gold);
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            animation: pulse 2s infinite alternate; font-family: 'Times New Roman', serif;
        }
        @keyframes pulse { from { transform: scale(1); filter: brightness(1); } to { transform: scale(1.05); filter: brightness(1.4); } }

        /* 2. INTERFACE TIKTOK & SOLDE */
        .header { position: fixed; top: 0; width: 100%; padding: 15px; display: flex; justify-content: space-between; align-items: center; z-index: 100; box-sizing: border-box; }
        .wallet-badge { background: rgba(255,255,255,0.15); padding: 8px 15px; border-radius: 20px; color: var(--gold); font-weight: bold; cursor: pointer; backdrop-filter: blur(10px); }
        
        .feed { height: 100vh; overflow-y: scroll; scroll-snap-type: y mandatory; }
        .video-card { height: 100vh; width: 100%; scroll-snap-align: start; position: relative; background: #000; }
        video { width: 100%; height: 100%; object-fit: cover; }

        /* 3. ACTIONS LAT√âRALES */
        .side-actions { position: absolute; right: 15px; bottom: 120px; display: flex; flex-direction: column; gap: 25px; align-items: center; }
        .icon { font-size: 30px; cursor: pointer; text-shadow: 0 2px 10px rgba(0,0,0,0.8); transition: 0.2s; }
        .icon:active { transform: scale(1.3); }

        /* 4. SYST√àME DE MODALS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 1000; padding: 25px; box-sizing: border-box; overflow-y: auto; }
        .btn-gold { background: var(--gold); color: #000; border: none; padding: 15px; width: 100%; font-weight: bold; border-radius: 12px; cursor: pointer; margin: 15px 0; font-size: 16px; }
        .btn-close { position: absolute; top: 20px; right: 20px; color: #fff; font-size: 24px; background: none; border: none; }
        input, select, textarea { width: 100%; padding: 14px; margin: 10px 0; background: #1a1a1a; border: 1px solid #333; color: #fff; border-radius: 10px; box-sizing: border-box; }

        /* 5. BAN & S√âCURIT√â */
        #ban-screen { display: none; position: fixed; inset: 0; background: #000; z-index: 10000; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; }
        
        .nav-bar { position: fixed; bottom: 0; width: 100%; display: flex; justify-content: space-around; padding: 20px; background: linear-gradient(transparent, rgba(0,0,0,0.9)); pointer-events: auto; }
    </style>
</head>
<body>

    <div id="splash">
        <div class="grand-v" id="main-logo">V</div>
        <div style="letter-spacing: 10px; font-weight: bold; opacity: 0.7;">NEXUSV</div>
    </div>

    <div id="ban-screen">
        <h1 style="color: var(--red);">COMPTE BANNI</h1>
        <p id="ban-msg">Contenu interdit d√©tect√©.</p>
        <p>R√©cup√©ration de compte :</p>
        <h2 id="ban-price" style="color: var(--gold);">200 ‚Ç¨</h2>
        <button class="btn-gold" onclick="window.location.href='LIEN_STRIPE_AMENDE'">PAYER POUR R√âACTIVER</button>
    </div>

    <div class="header">
        <div style="font-weight: 900; font-size: 22px; color: var(--gold); font-style: italic;">NEXUSV</div>
        <div class="wallet-badge" onclick="toggleModal('wallet-modal')">
            ü™ô <span id="user-balance">0.00</span> ‚Ç¨
        </div>
    </div>

    <div class="feed" id="video-feed">
        </div>

    <div class="nav-bar">
        <span class="icon" onclick="location.reload()">üè†</span>
        <span class="icon" onclick="toggleModal('upload-modal')">‚ûï</span>
        <span class="icon" onclick="toggleModal('nexus-contact')">üí¨</span>
        <span class="icon" onclick="checkAdminAccess()">üëë</span>
    </div>

    <div id="wallet-modal" class="modal">
        <button class="btn-close" onclick="toggleModal('wallet-modal')">‚úï</button>
        <h2 style="color: var(--gold);">Portefeuille NexusV</h2>
        <p>Solde mon√©tisable : <span id="modal-balance" style="font-size: 24px;">0.00</span> ‚Ç¨</p>
        <hr style="border: 0.5px solid #222;">
        <h3>Retrait Mobile Money (IA 5s)</h3>
        <select id="w-method">
            <option value="wave">Wave üåä</option>
            <option value="orange">Orange Money üüß</option>
            <option value="mtn">MTN MoMo üü®</option>
            <option value="moov">Moov Money üü¶</option>
        </select>
        <input type="number" id="w-amount" placeholder="Montant">
        <input type="text" id="w-phone" placeholder="Num√©ro de compte">
        <button class="btn-gold" onclick="processWithdrawal()">VALIDER LE RETRAIT</button>
    </div>

    <div id="upload-modal" class="modal">
        <button class="btn-close" onclick="toggleModal('upload-modal')">‚úï</button>
        <h2>Publier sur l'Empire</h2>
        <input type="file" id="v-file" accept="video/*,audio/*,image/*">
        <textarea id="v-desc" placeholder="D√©crivez votre publication..."></textarea>
        <button class="btn-gold" onclick="handleUpload()">ANALYSER & PUBLIER</button>
    </div>

    <script>
        // --- üî¥ CONFIGURATION SUPABASE (REMPLACE ICI) ---
        const= "TA_URL_SUPABASE";
(https://drrwmuzocggrhtvshpdg...)        const  = "TA_CLE_ANON";
        const supabase = supabase.createClient(SB_URL, SB_KEY);

        let userProfile = null;

        window.onload = async () => {
            const { data: { user } } = await supabase.auth.getUser();
            
            if (user) {
                const { data: profile } = await supabase.from('profiles').select('*').eq('id', user.id).single();
                userProfile = profile;

                // 1. Logo intelligent (Or ou Diamant)
                if(profile.is_certified || profile.is_monetized) {
                    document.getElementById('main-logo').style.color = "#00d1ff";
                    document.getElementById('main-logo').style.textShadow = "0 0 30px #00d1ff";
                }

                // 2. V√©rification Bannissement
                if(profile.is_banned) {
                    document.getElementById('ban-screen').style.display = 'flex';
                    document.getElementById('ban-price').innerText = profile.followers_count >= 2000000 ? "1000 ‚Ç¨" : "200 ‚Ç¨";
                }

                document.getElementById('user-balance').innerText = profile.wallet_balance.toFixed(2);
                document.getElementById('modal-balance').innerText = profile.wallet_balance.toFixed(2);
            }

            // Splash timeout
            setTimeout(() => {
                document.getElementById('splash').style.opacity = '0';
                setTimeout(() => document.getElementById('splash').style.display = 'none', 800);
            }, 3000);

            loadFeed();
        };

        async function loadFeed() {
            const { data: videos } = await supabase.from('videos').select('*, profiles(username, is_certified)').order('created_at', {ascending:false});
            const feed = document.getElementById('video-feed');
            feed.innerHTML = videos.map(v => `
                <div class="video-card">
                    <video src="${v.video_url}" loop playsinline onclick="this.play()"></video>
                    <div class="side-actions">
                        <span class="icon" onclick="alert('Like ‚ù§Ô∏è')">‚ù§Ô∏è</span>
                        <span class="icon" onclick="alert('Cadeau üéÅ (Com: 60%)')">üéÅ</span>
                        <span class="icon" onclick="reportVideo('${v.id}')">üö©</span>
                    </div>
                    <div style="position:absolute; bottom:110px; left:20px; text-shadow: 0 2px 10px #000;">
                        <b>@${v.profiles.username} ${v.profiles.is_certified ? '‚úîÔ∏è' : ''}</b>
                        <p>${v.description}</p>
                    </div>
                </div>
            `).join('');
        }

        async function processWithdrawal() {
            const amt = document.getElementById('w-amount').value;
            alert("IA NexusV : Analyse de s√©curit√© en cours... (5s)");
            setTimeout(() => {
                alert(`‚úÖ Retrait de ${amt}‚Ç¨ valid√© par l'IA vers votre compte.`);
                toggleModal('wallet-modal');
            }, 5000);
        }

        function toggleModal(id) {
            const m = document.getElementById(id);
            m.style.display = (m.style.display === 'block') ? 'none' : 'block';
        }

        async function checkAdminAccess() {
            if(userProfile && userProfile.username === 'YOUSSEF_ADMIN') {
                alert("Bienvenue Ma√Ætre.");
                // Ouvrir panel admin ici
            } else {
                alert("R√©serv√© au cr√©ateur de NexusV.");
            }
        }

        async function reportVideo(id) {
            const r = confirm("Signaler cette vid√©o pour contenu inappropri√© ?");
            if(r) alert("Signalement envoy√© √† Youssef pour examen.");
        }
    </script>
</body>
</html>
